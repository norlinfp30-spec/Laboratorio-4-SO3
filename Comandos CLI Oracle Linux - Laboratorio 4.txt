# Práctica 1: Servidor HTTP Apache2 / Nginx (1 punto)

# Paso 1: Instalar Apache
sudo dnf install httpd -y
sudo systemctl enable --now httpd

# Verifica:
sudo systemctl status httpd

# Verificamos si esta el servicio httpd en el firewall
sudo firewall-cmd --list-all
# Agregamos el servicio
sudo firewall-cmd --add-service=http --permanent
sudo firewall-cmd --reload

# Crear la carpeta
sudo mkdir -p /var/www/html/hola
# Editar el archivo index.html
sudo nano /var/www/html/hola/index.html

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Datos Personales</title>
</head>
<body>
    <h1>Hola Mundo</h1>
</body>
</html>

# Paso 3: Crear el VirtualHost que escuche en el puerto 80
# Edita el archivo:
sudo nano /etc/httpd/conf.d/hola.conf
# Agrega:
<VirtualHost *:80>
    ServerAdmin webmaster@nolberto
    DocumentRoot /var/www/html/hola
    ServerName hola.local
    ErrorLog /var/log/httpd/hola-error.log
    CustomLog /var/log/httpd/hola-access.log combined
</VirtualHost>
# Guarda, luego:
sudo systemctl restart httpd

# Desde el navegador o cliente:
http://<ip-del-servidor>
# Deberías ver:
# Hola Mundo

# Paso 4: Crear website con tu nombre, matrícula y materia
# Ejemplo:
sudo mkdir -p /var/www/html/datos
sudo nano /var/www/html/datos/index.html

# Pega esto
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Datos Personales</title>
</head>
<body>
    <h1>Nolberto Francisco Perez</h1>
    <h1>2025-2263</h1>
    <h1>Sistemas Operativos 3</h1>
</body>
</html>

# Paso 5: Crear el VirtualHost en el puerto 8080
# Edita:
sudo nano /etc/httpd/conf.d/datos.conf
# Agrega:
<VirtualHost *:8080>
    ServerAdmin webmaster@nolberto
    DocumentRoot /var/www/html/datos
    ServerName datos.local
    ErrorLog /var/log/httpd/datos-error.log
    CustomLog /var/log/httpd/datos-access.log combined
</VirtualHost>

# Agregar el puerto 8080 al firewall
sudo firewall-cmd --ad-port=8080/tcp --permanent
sudo firewall-cmd --reload
sudo firewall-cmd --list-all

# Reinicia el servicio:
sudo systemctl restart httpd

# Desde el navegador:
http://<ip-del-servidor>:8080

Practica 2: Instalar un servidor de correos (2pts)


#  Instalar Postfix y mailx
sudo dnf install postfix mailx -y

# Habilitar y levantar Postfix
sudo systemctl enable --now postfix
sudo systemctl start postfix
sudo systemctl status postfix

# Configurar Postfix para Gmail
sudo nano /etc/postfix/main.cf
# Dentro de nano, asegúrate de tener estas líneas:

myhostname = nolberto.rhel.com
mydomain = rhel.com
myorigin = $myhostname
mydestination = $myhostname, localhost.localdomain, localhost
inet_interfaces = all
inet_protocols = ipv4
mynetworks = 192.168.0.0/24, 127.0.0.0/8

relayhost = [smtp.gmail.com]:587
smtp_use_tls = yes
smtp_sasl_auth_enable = yes
smtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd
smtp_sasl_security_options = noanonymous
smtp_sasl_tls_security_options = noanonymous
smtp_tls_CAfile = /etc/ssl/certs/ca-bundle.crt

# Guarda con Ctrl+O → Enter y sale con Ctrl+X

# Crear archivo de credenciales SASL
sudo nano /etc/postfix/sasl_passwd
# Dentro de nano, escribe EXACTO:
# [smtp.gmail.com]:587 norlinfp30@gmail.com:vyhe nudo ptpc xncv
# En un entorno real deberías usar un App Password de Gmail

# Dar permisos y generar hash
sudo chmod 600 /etc/postfix/sasl_passwd
sudo postmap /etc/postfix/sasl_passwd

# Reiniciar Postfix
sudo systemctl restart postfix

# Enviar correo de prueba al maestro
echo "Nombre: Nolberto Francisco Perez - Mat: 20252263" | mailx -s "MambruSeFueALaGuerra" os3conadrian@gmail.com

# Verificar logs de envío
sudo tail -f /var/log/maillog


Practica 3 

• Práctica 3
Paso 1: Instalar CUPS en Oracle Linux 9

Abrir terminal en Oracle Linux 9.

Instalar CUPS y cliente:

sudo dnf install cups cups-client -y

Habilitar y arrancar el servicio:

sudo systemctl enable cups --now
sudo systemctl start cups

Verificar que esté activo:

sudo systemctl status cups

Comprobar que el puerto 631 está escuchando:

sudo ss -tlnp | grep 631
Paso 2: Configurar acceso remoto en CUPS

Editar archivo de configuración:

sudo nano /etc/cups/cupsd.conf

Modificar/agregar estas líneas:

Listen 0.0.0.0:631
Port 631

<Location />
  Order allow,deny
  Allow 192.168.0.*
</Location>

<Location /admin>
  Order allow,deny
  Allow 192.168.0.*
</Location>

<Location /admin/conf>
  AuthType Default
  Require user @SYSTEM
  Order allow,deny
  Allow 192.168.0.*
</Location>

Guardar y cerrar (Ctrl+O, Enter, Ctrl+X).

Reiniciar CUPS:

sudo systemctl restart cups
Paso 3: Instalar impresora virtual PDF

Instalar paquete PDF:

sudo dnf install cups-pdf -y

Verificar impresora:

lpstat -p

La impresora virtual CUPS-PDF genera PDFs en:

/var/spool/cups-pdf/ANONYMOUS
Paso 4: Configurar firewall

Permitir acceso al puerto 631:

sudo firewall-cmd --add-port=631/tcp --permanent
sudo firewall-cmd --reload
Paso 5: Configuración opcional vía web

Abrir navegador desde cualquier PC de la red:

http://192.168.0.199:631

Ir a Administración → Añadir impresora.

Seleccionar CUPS-PDF, configurar nombre y driver.

Guardar cambios.

Paso 6: Instalar impresora en Windows 11

Abrir Configuración → Dispositivos → Impresoras y escáneres → Agregar impresora.

Seleccionar “La impresora que quiero no está en la lista”.

Elegir Agregar impresora usando dirección TCP/IP o nombre de host.

Tipo: TCP/IP Device.

Dirección: 192.168.0.199, Puerto: 631.

Instalar driver PDF compatible (o usar Microsoft Print to PDF).

Nombrar impresora: CUPS-PDF.

Paso 7: Probar la impresora

Abrir un documento de Word en Windows 11.

Imprimir usando la impresora CUPS-PDF.

En Oracle Linux, verificar que se generó el PDF:

ls /var/spool/cups-pdf/ANONYMOUS

